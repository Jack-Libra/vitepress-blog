# ğŸ§  å¾è…³æœ¬çˆ¬èŸ²åˆ°æ¨¡çµ„åŒ–è³‡æ–™æµï¼šç”¨ n8n + crawl4ai æ‰“é€ é›»å•†åˆ†æå¹³å°
ğŸ“Œ TL;DRï¼šé€™æ˜¯åå‘æ–¼æŠ€è¡“å¯¦æˆ°å°å‘çš„æ–‡ç« ã€‚æˆ‘å°‡èšç„¦æ–¼å¦‚ä½•ä»¥ n8n æ­é… crawl4ai å»ºæ§‹å‡ºä¸€å¥—æ¨¡çµ„åŒ–ã€è‡ªå‹•åŒ–çš„é›»å•†è³‡æ–™åˆ†æå¹³å°ï¼Œä¸¦åˆ†äº«æˆ‘ç‚ºä»€éº¼é¸æ“‡é€™å¥—çµ„åˆã€‚å…§å®¹å°‡åŒ…å«n8nä¸­æ¯å€‹ç¯€é»çš„é…ç½®ã€æµç¨‹é‚è¼¯ã€éŒ¯èª¤è™•ç†ã€è³‡æ–™æ¸…æ´—ã€æ’ç¨‹åŸ·è¡Œèˆ‡è·¨å¹³å°ä¸²æ¥ç­‰ã€‚


## âœ… ç‚ºä»€éº¼é¸æ“‡ n8n + crawl4aiï¼Ÿ
|     å·¥å…·     |                          å„ªå‹¢                          |
|:------------:|:------------------------------------------------------:|
|   **n8n**    |    è¦–è¦ºåŒ–æµç¨‹è¨­è¨ˆã€è‡ªå‹•æ’ç¨‹ã€æ˜“é™¤éŒ¯ã€ä¸²æ¥ DB / API     |
| **crawl4ai** | åŸºæ–¼ CSS selectorã€YAML è¨­å®šã€ç©©å®šè¼•å·§ã€å¿«é€Ÿæ“´å±•å¤šç¶²ç«™ |

## å€‹äººå› ç´ 
- **ã€Œè‡ªå‹•åŒ–ã€æ›´ç¬¦åˆçˆ¬èŸ²æœ¬è³ª** *(æˆ‘èªç‚ºæœ€é‡è¦çš„)*
- å®Œå…¨é–‹æºä¸”å…è²»çš„å·¥å…·
- å¯æ“´å……æ€§èˆ‡å„ªç§€çš„æ•ˆèƒ½è¡¨ç¾


## ğŸ› ï¸ N8N è‡ªå‹•åŒ–æµç¨‹è¨­è¨ˆè§£æ
### æµç¨‹ç¸½è¦½
![è¢å¹•æ“·å–ç•«é¢ 2025-07-28 174209](/images/ç¬¬äºŒç¯‡/N8Næµç¨‹ç¸½è¦½.png)
## 1ï¸âƒ£è«‹æ±‚ä»»å‹™ crawl post
```
(1)  ä¸åŒéƒ¨ç½²ç’°å¢ƒä¸‹ï¼ŒURL çš„è¨­å®šæ–¹å¼ä¹Ÿæœƒä¸åŒ
Docker Compose(å°ˆæ¡ˆdefault) http://crawl4ai:11235/crawl
n8nã€crawl4ai è·‘æœ¬æ©Ÿ http://localhost:11235/crawl
n8nã€crawl4ai è·‘æœ¬æ©Ÿdockerå®¹å™¨ http://host.docker.internal:11235/crawl
é›²ç«¯ä¸»æ©Ÿ https://your-domain.com/crawl

(2) credential
Bearer CRAWL4AI_API_TOKEN
CRAWL4AI_API_TOKEN æ–¼ docker-composeè¨­å®šï¼Œdefault:0000

(3) çˆ¬èŸ² URL
é–‹å•Ÿæ¬²çˆ¬å–ç¶²é devtoolsä»¥é‡æ–°è¨­å®šè©²ç¶²é css
**ç¤ºç¯„ç¶²é :https://www.amazon.com/-/zh_TW/gp/bestsellers/electronics/ref=pd_zg_ts_electronics** 
**å¯é€ésitemapç²å¾—å¤§é‡æ¬²çˆ¬å–ç¶²é **

(4) URLè¨­å®šå°æ‡‰ crawl post
Docker Compose(å°ˆæ¡ˆdefault) http://crawl4ai:11235/task/taskID
n8nã€crawl4ai è·‘æœ¬æ©Ÿ http://localhost:11235/task/taskID
n8nã€crawl4ai è·‘æœ¬æ©Ÿdockerå®¹å™¨ http://host.docker.internal:11235/task/taskID
é›²ç«¯ä¸»æ©Ÿ https://your-domain.com/task/taskID
```
<table>
	<tr>
	    <td align="center">æµç¨‹</td>
	    <td align="center">ç¯€é»</td>
	    <td align="center">èªªæ˜</td>
	</tr >
    <tr>
        <th rowspan="3">é€éå°ˆå±¬ APIç²å–è³‡æ–™</th>
        <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/1-1.png"/>HTTP Request
        </td>
        <td align="center">å‘crawl4ai POST/GET ä»»å‹™ï¼Œcrawl4aiå°‡è¿”å›ä»»å‹™ID</td>
    </tr>
    <tr>
         <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/1-2.png"/>HTTP Request
        </td>
         <td align="center">ä¾æ“šä»»å‹™ID GET çµæœ</td>
    </tr>
    <tr>
	     <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/1-3.png"/>EDIT FIELDS+IF
        </td>
         <td align="center">åˆ¤æ–·ä»»å‹™æ˜¯å¦æˆåŠŸ</td>
	</tr>
</table>



## 2ï¸âƒ£è³‡æ–™æ¸…æ´—
<table>
	<tr>
	    <td align="center">æµç¨‹</td>
	    <td align="center">ç¯€é»</td>
	    <td align="center">èªªæ˜</td>
	</tr >
    <tr>
        <th rowspan="2">è³‡æ–™æ¸…æ´—ã€æ¬„ä½æ•´ç†</th>
        <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/2-1.png"/>CODE
        </td>
        <td >å°‡çˆ¬å–è³‡æ–™åšæ¸…æ´— ä¾‹:[a,b,1,2,A,B]â†’[a,b]ã€[1,2]ã€[A,B]</td>
    </tr>
    <tr>
         <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/2-2.png" />      SPLIT OUT
        </td>
         <td>åˆ†é…è³‡æ–™å±¬æ€§ï¼Œ1 item=1 product ä¾‹:[a,b]ã€[1,2]ã€[A,B]â†’[a,1,A]ã€[b,2,B]</td>
    </tr>
</table>


## 3ï¸âƒ£å­˜é€²è³‡æ–™åº«
```
(1) HTTP Requestç¯€é»:è«‹æ±‚æŸ¥çœ‹productsè¡¨æ˜¯å¦æœ‰é‡è¤‡ID
URL:https://<your-project-id>.supabase.co/rest/v1/products?product_code=eq.productID

(2) HTTP Request credentials:
apikey : your-anon-key
Authorization : Bearer your-anon-key

(3) supabase credentials
Host : NEXT_PUBLIC_SUPABASE_URL(https://your_account.supabase.co)
Service Role Secret : Bearer service_role API keys
```
<table>
	<tr>
	    <td align="center">æµç¨‹</td>
	    <td align="center">ç¯€é»</td>
	    <td align="center">èªªæ˜</td>
	</tr >
    <tr>
        <th rowspan="3">å‘¼å«SUPABASE API</th>
        <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/3-1.png"/>Loop Over Items
        </td>
        <td align="center">ä¸€æ¬¡è™•è£¡ä¸€ç­†å•†å“</td>
    </tr>
    <tr>
         <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/3-2.png" />      HTTP Request
        </td>
         <td align="center">æ ¹æ“šproductIDæŸ¥è¨ŠSUPABASEè³‡æ–™åº«</td>
    </tr>
    <tr>
         <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/3-3.png" />      IF
        </td>
         <td align="center">æ ¹æ“šçµæœåˆ¤æ–·æœ‰ç„¡å•†å“è³‡æ–™</td>
    </tr>
    <tr>
        <th rowspan="2">å­˜å…¥è³‡æ–™åº«</th>
        <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/3-4.png"/>SUPABASE
        </td>
        <td align="center">å¦‚æœè³‡æ–™åº«æ²’å•†å“è³‡æ–™ï¼Œå‰‡å…ˆå­˜å…¥product tableï¼Œå†é€²snapshot tableã€‚</td>
    </tr>
    <tr>
         <td align="center">
            <img src="/images/ç¬¬äºŒç¯‡/3-5.png" />      SUPABASE
        </td>
         <td align="center">å¦‚æœè³‡æ–™åº«æœ‰è³‡æ–™ï¼Œç›´æ¥é€²å…¥snapshot tableï¼Œè¨˜éŒ„æ­¤æ¬¡çˆ¬èŸ²çµæœã€‚</td>
    </tr>
</table>


## 0ï¸âƒ£ crawl4ai è«‹æ±‚æ ¼å¼(css strategy)
```
{
  "urls": ["https://www.amazon.com/-/zh_TW/gp/bestsellers/electronics/ref=pd_zg_ts_electronics"], 
"crawler_params": {
  "headless": true,
  "wait_before_extract": 3000},
  "extraction_config": {
    "type": "json_css",
    "params": {
      "schema": {
        "name": "character",
        "baseSelector": "div.p13n-desktop-grid",
        "fields": [
              {
                "name": "Name",
                "selector": "._cDEzb_p13n-sc-css-line-clamp-3_g3dy1",
                "type": "list",
                "fields":[{"name": "Name","type": "text"}]
               },
              {
                "name": "AsinList",
                "selector": "._cDEzb_iveVideoWrapper_JJ34T",
                "type": "list",
                "fields":[{"name": "asin",
      "type": "attribute",
      "attribute": "data-asin"}]
               },
              {
                "name": "Rank",
                "selector": "span.zg-bdg-text",
                "type": "list",
                "fields":[{"name": "Name","type": "text"}]
               },
              {
                "name": "Rate",
                "selector": ".a-icon-row",
                "type": "list",
                "fields":[{"name": "Name","type": "text"}]
               },
              {
                "name": "Price",
                "selector": "span.p13n-sc-price, span._cDEzb_p13n-sc-price_3mJ9Z",
                "type": "list",
                "fields":[{"name": "Name","type": "text"}]
               }
                    ]
      },
      "verbose": true
    }
  },
  "cache_mode": "bypass",
  "semphore_count": 1,

"delay_between_requests": 3000  
}
```


## ğŸ” ç³»çµ±è§€æ¸¬èˆ‡éŒ¯èª¤è™•ç†æ©Ÿåˆ¶
- âœ… ç³»çµ±ç›£æ§
- ğŸ“¤ æˆåŠŸèˆ‡å¤±æ•—ç´€éŒ„æ¨é€ Slack
- ğŸ” JSON Schema é©—è­‰è³‡æ–™å®Œæ•´æ€§
- ğŸ“ˆ å•†å“æ•¸ã€åƒ¹æ ¼ç•°å¸¸æ¯”ä¾‹æ¯æ—¥çµ±è¨ˆ
- ğŸ§ª Debug æ¨¡å¼é¡¯ç¤ºåŸå§‹ JSON çµæœ

## âŒ å¸¸è¦‹éŒ¯èª¤èˆ‡è§£æ³•
|        å•é¡Œ         |                       è§£æ³•                       |
|:-------------------:|:------------------------------------------------:|
| Selector æŠ“ä¸åˆ°è³‡æ–™ | DevTools æ‰‹å‹•æ¸¬è©¦ï¼Œé¿å…ä½¿ç”¨å‹•æ…‹ç”¢ç”Ÿçš„ class åç¨± |
|  JSON æ¬„ä½å‹åˆ¥éŒ¯èª¤  |  Function Node åŠ å…¥å‹åˆ¥å¼·åˆ¶è½‰æ› (å¦‚ \`Number(x)  |
|  Supabase å¯«å…¥å¤±æ•—  |       æª¢æŸ¥æ¬„ä½å‘½åã€å¤§å°å¯«ä¸€è‡´æ€§èˆ‡æ ¼å¼è¨­å®š       |
|  n8n ç„¡æ³•è§£æçµæ§‹   |        ç”¨ `item[0].json` è·¯å¾‘è™•ç†å¤šå±¤çµæ§‹        |


## ğŸ“Š è‡ªå‹•åŒ–å¸¶ä¾†çš„æ•ˆç›Š
|       æŒ‡æ¨™       |       æ‰‹å‹•æ–¹å¼       | è‡ªå‹•æµç¨‹ï¼ˆn8n + crawl4aiï¼‰  |
|:----------------:|:--------------------:|:---------------------------:|
|   è³‡æ–™æ›´æ–°é »ç‡   | å¶çˆ¾ï¼Œå–æ±ºæ–¼äººåŠ›æ™‚é–“ |    æ¯æ—¥è‡ªå‹•ï¼Œæ™‚é–“å¯é…ç½®     |
| æ“´å……ç¶²ç«™è³‡æ–™ä¾†æº |      è¦å¯«æ–°ç¨‹å¼      | åƒ…æ–°å¢ selector YAML + ç¯€é» |
| è³‡æ–™éŒ¯èª¤åµæ¸¬èƒ½åŠ› |      é äººå·¥æª¢æŸ¥      |    Slack é€šçŸ¥ + éŒ¯èª¤è¨˜éŒ„    |
|  å¤šå¹³å°éƒ¨ç½²èƒ½åŠ›  |        é›£æ•´åˆ        |   æ¨¡çµ„åŒ–æ¶æ§‹æ”¯æ´ç¨ç«‹éƒ¨ç½²    |

## ğŸš€ å¯æ“´å……æ‡‰ç”¨è¦åŠƒ
âœ… å•†å“åƒ¹æ ¼æ­·å²ç´€éŒ„èˆ‡æ¯”åƒ¹è¶¨å‹¢

âœ… æ¯æ—¥/æ¯é€±å ±è¡¨è‡ªå‹•ç”Ÿæˆï¼ˆCSV / PDFï¼‰

âœ… çµåˆ GPT å°å•†å“é€²è¡Œæ‘˜è¦èˆ‡åˆ†ç¾¤

âœ… çµåˆ Telegram / LINE Bot ç”¨æˆ¶äº’å‹•æŸ¥è©¢

âœ… æä¾›å…¬é–‹ API ä¾›ä»–äººä¸²æ¥ç†±é–€å•†å“æ’è¡Œ

## ğŸ§  çµèªï½œçˆ¬èŸ²ä¸æ˜¯ç›®çš„ï¼Œè³‡æ–™æµæ‰æ˜¯åƒ¹å€¼
å¾ä¸€éš»è…³æœ¬çˆ¬èŸ²è½‰å‘ä¸€æ¢è‡ªå‹•åŒ–è³‡æ–™ç®¡ç·šï¼Œæˆ‘å­¸åˆ°çš„ä¸åªæ˜¯æŠ€è¡“ï¼Œæ›´æ˜¯å¦‚ä½•è¨­è¨ˆä¸€å¥—ç©©å®šã€å¯è§€æ¸¬ã€å¥½æ“´å……çš„è³‡æ–™è™•ç†æ¶æ§‹ã€‚

å¦‚æœä½ ä¹Ÿæƒ³ï¼š

- æ“ºè„«æ‰‹å‹•åŸ·è¡Œçˆ¬èŸ²è…³æœ¬çš„æ—¥å¸¸

- æå‡çˆ¬èŸ²ç©©å®šæ€§èˆ‡è³‡æ–™æµç¨‹æ•´åˆ

- æ‰“é€ å¯å»¶ä¼¸çš„åˆ†æç³»çµ±

é‚£éº¼ï¼šn8n + crawl4ai æ˜¯å¾ˆå€¼å¾—å˜—è©¦çš„çµ„åˆã€‚

ğŸ“¢ æƒ³çœ‹æ›´å¤š n8n æˆ–é›»å•†çˆ¬èŸ²å¯¦æˆ°ï¼Ÿ  
ğŸ“ æ­¡è¿è¿½è¹¤æˆ‘çš„ Medium / GitHub ğŸ‘‰ [@Jack-Libra](https://github.com/Jack-Libra)  
ğŸ’¬ å¦‚æœä½ å°é€™å€‹å°ˆæ¡ˆæœ‰ä»»ä½•å»ºè­°æˆ–æƒ³æ³•ï¼Œæ­¡è¿ç•™è¨€äº¤æµï¼
